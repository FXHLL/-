<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>图片懒加载</title>
</head>

<body>
  <div id="container">
    <img class="cut-img" src="http://127.0.0.1:3000/static/picture/0?path=default.png" title="占位图" />
  </div>
</body>
<script type="module">
  import { xml_fn } from './xml.js'
  // 旧方法实现：
  // 原理：监听图片资源的容器是否出现在视口中
  // 监听事件：scroll，scroll事件可能会频繁触发，需要节流
  // 判断方法：Element.getBoundingClientRect() 返回元素大小，相对视窗的位置信息[元素左上角和视窗左上角]
  async function getData() {
    const res = await xml_fn({
      method: 'GET',
      url: '/getData/picData',
      params: '',
      dataType: 'JSON'
    }).catch(e => { console.log('httpE', e) })
    console.log('res',res)
    const container = document.querySelector('#container')
    console.log(container)
    let arr = []
    res.forEach(item => {
      const img = document.createElement('img')
      img.src = 'http://127.0.0.1:3000/static/picture/0?path=default.png'
      img.className = 'cut-img'
      arr.push(img)
      container.appendChild(img)
    })

  }
  getData()
</script>

</html>
<style>
  #container {
    display: flex ;
    flex-wrap: wrap;
    width: 100vw;
    background-color: aquamarine;
  }
  .cut-img{
    width: 15vw;
    height: 300px;
    border: 2.5vw solid white;
  }
</style>